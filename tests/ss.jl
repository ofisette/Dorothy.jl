using Test
using LinearAlgebra
using Dorothy
using Dorothy.Graphs
using Dorothy.Geometry
using Dorothy.PBC
using Dorothy.SS
using Formats
using FormatStreams

datapath = joinpath(@__DIR__, "..", "data")

@testset "Secondary structure" begin

	@testset "Guessing SS" begin
		m1 = readf("$(datapath)/1BTL.gro")
		guessss!(m1)
		@test m1.SS == ["C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "C", "C", "C", "C", "C", "C", "C", "C", "C", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "C", "C", "C", "C", "C", "C", "C", "C", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "C", "C", "C", "C",
				"C", "C", "C", "C", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "C", "C", "C", "C", "C", "C", "C", "C", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "C", "C", "C",
				"C", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "B", "B", "B", "B", "B", "B",
				"B", "B", "B", "B", "B", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "C", "C", "C", "C", "C", "C", "C", "C",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "C", "C", "C", "C", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G", "G",
				"G", "G", "G", "G", "G", "G", "G", "C", "C", "C", "C", "C", "C",
				"C", "C", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T",
				"T", "T", "T", "T", "T", "T", "T", "T", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",
				"E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H",
				"H", "H", "H", "H", "C", "C", "C", "C", "C", "C", "C", "C", "C",
				"C", "C", "C", "C", "C", "C", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
				"", "", "", ""]
	end

end # @testset
